<p id="notice"><%= notice %></p>

<p>
  <strong>Name:</strong>
  <%= @pair.name %>
</p>
<% unless @pair.ticker.nil? %>
  <p>
    <strong>High:</strong>
    <%= @pair.ticker.high %>
  </p>
  <p>
    <strong>Low:</strong>
    <%= @pair.ticker.low %>
  </p>
<% end %>
<div>
  <%= link_to 'Update Data', pair_ticker_path(@pair), method: :patch %>
</div>
<div>
  <%= link_to 'Show History', pair_history_path(@pair) %>
</div>
<%= link_to 'Edit', edit_pair_path(@pair) %> |
<%= link_to 'Back', pairs_path %>


<%=
  require_relative '../../../lib/ws'

  # Configure the client with the proper KEY/SECRET, you can create a new one from:
  # https://www.bitfinex.com/api

  client = Bitfinex::Client.new
  pair = "ETHUSD"

  # Documentation: https://bitfinex.readme.io/reference#ws-public-ticker
  #
  # Array comes with the following values:
  #  1  BID   float   Price of last highest bid
  #  2  BID_SIZE  float   Size of the last highest bid
  #  3  ASK   float   Price of last lowest ask
  #  4  ASK_SIZE  float   Size of the last lowest ask
  #  5  DAILY_CHANGE  float   Amount that the last price has changed since yesterday
  #  6  DAILY_CHANGE_PERC   float   Amount that the price has changed expressed in percentage terms
  #  7  LAST_PRICE  float   Price of the last trade.
  #  8  VOLUME  float   Daily volume
  #  9  HIGH  float   Daily high
  #  10 LOW   float   Daily low
  #
  # configure the listener:
  client.listen_ticker(pair) do |tick|
    puts "Last Price: #{tick[7]}\t High: #{tick[9]}\t Low: #{tick[10]}"
  end

  puts "Bitfinex Ticker Price for #{pair}:"
  client.listen!


%>